<div class="col-md-12">
    <h3 translate>List of all chats</h3>
    <div block-ui="chatsBlockUI"></div>
    <div class="col-md-12">
        <div ng-repeat="chat in chats" class="col-md-2">
            <a href="" ng-click="selectChat(chat)">
                <span class="img-circle" style="display: block; width: 140px; height: 140px; text-align: center; padding-top: 60px; background-color: #BEBDBD">
                {{chat.user.ip}}
                <br/>
                {#{(chat.messages|filter:!readed).length}#}
                </span>
            </a>
        </div>
    </div>
    <div ng-show="current_chat">
        <div block-ui="currentChatBlockUI"></div>
        <div class="col-md-9">
            <div class="well message-spot overflowable" auto-scroll>
                <p ng-repeat="message in current_chat.messages track by $index;" ng-class="{'not-readed': !message.readed}">
                    <span ng-if="message.sender_type == c.MESSAGE_SENDER_TYPE_USER" class="green">
                        {{ message.created_at * 1000 | date:'shortTime' }}: {{current_chat.user.first_name}}: {{message.text}}
                    </span>
                    <span ng-if="message.sender_type == c.MESSAGE_SENDER_TYPE_AGENT" class="red">
                        {{ message.created_at * 1000 | date:'shortTime' }}: {{agent.first_name}}: {{message.text}}
                    </span>
                </p>
            </div>
            <form ng-submit="sendMessage()" class="form-horizontal" role="form">
                <div class="col-md-10">
                    <input ng-model="text" class="form-control" placeholder="Enter message" />
                </div>
                <div class="col-md-2">
                    <button type="submit" class="btn btn-success" ng-disabled="!current_chat" translate>Send</button>
                </div>
            </form>
        </div>
        <div class="col-md-3">
            <p>{{current_chat.user.ip}}: {{current_chat.user.first_name}}</p>
            <p>{{current_chat.user.country}}, {{current_chat.user.city}}</p>
            <p>{{current_chat.user.os}} {{current_chat.user.browser}}</p>
        </div>
    </div>
</div>